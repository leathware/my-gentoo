# /etc/portage/make.conf — KDE Plasma desktop
# Hardware: AMD Ryzen 9 9800X3D · RX 7800 XT · X870 Taichi Lite · DVD reader
# Init: OpenRC
# ------------------------------------------------------------------

# ── Compiler flags (Zen 5) ──────────────────────────────────────────
# -march=native lets GCC detect the exact µarch at compile time.
# If you cross-compile or distcc, replace with -march=znver5 (GCC ≥ 14).
COMMON_FLAGS="-march=native -O2 -pipe"
CFLAGS="${COMMON_FLAGS}"
CXXFLAGS="${COMMON_FLAGS}"
FCFLAGS="${COMMON_FLAGS}"
FFLAGS="${COMMON_FLAGS}"

# ── CPU FLAGS (inserted by setup-makeconf.sh) ───────────────────────
# CPU_FLAGS_X86="<populated at runtime by cpuid2cpuflags>"

# ── Parallelism (8C / 16T) ─────────────────────────────────────────
MAKEOPTS="-j16 -l16"
EMERGE_DEFAULT_OPTS="--jobs=4 --load-average=16 --with-bdeps=y --keep-going --autounmask-write"

# ── Portage behaviour ──────────────────────────────────────────────
FEATURES="candy fixlafiles unmerge-orphans parallel-fetch"
ACCEPT_LICENSE="-* @FREE @BINARY-REDISTRIBUTABLE"
ACCEPT_KEYWORDS="amd64"

# ── Hardware ────────────────────────────────────────────────────────
VIDEO_CARDS="amdgpu radeonsi"
INPUT_DEVICES="libinput"
GRUB_PLATFORMS="efi-64"

# ── Locale ──────────────────────────────────────────────────────────
L10N="en"
LINGUAS="en"
LC_MESSAGES=C.utf8

# ── Global USE — KDE Plasma full desktop ────────────────────────────
# Wayland-first but keep X11 for compatibility; PipeWire for audio;
# full Plasma/Qt6 stack; optical media support for the DVD drive.
USE="
  X wayland
  dbus elogind policykit udisks
  bluetooth networkmanager
  pipewire sound-server screencast
  vulkan opengl vaapi
  alsa
  dvd dvdread cdda cdr
  kde plasma qt6 qt5 widgets declarative qml
  activities semantic-desktop
  -gnome -systemd -telemetry
"
